# C++ 语言概念

### 基础概念

| 基础概念             | 内容 |
| -------------------- | ---- |
| 注释                 | 单行(`//`)、多行(`/* */`)，C++17嵌套注释支持 |
| ASCII编码            | 基础字符集(0-127)，C++11支持Unicode字面量 |
| 标点符号             | 运算符外的语法符号(`[]`, `{}`, `;`, `::`等) |
| 名称与标识符         | 字母/数字/下划线组成，区分大小写，非数字开头 |
| 类型                 | 基础类型 + 复合类型(指针/引用) + 类类型 |
| 基本类型             | `void`, `bool`, 整型(`char`, `int`等), 浮点型(`float`, `double`) |
| 对象                 | 存储区域，含类型/值/生存期/存储期属性 |
| 作用域               | 块作用域/类作用域/命名空间作用域/全局作用域 |
| 对象生存期           | 构造开始→析构结束，`malloc`创建的对象无生存期 |
| 存储持续期与链接性   | 自动/静态/线程/动态存储期，内部/外部/无链接 |
| 定义与ODR            | 单一定义规则(One Definition Rule)，跨编译单元限制 |
| 名称查找             | 普通查找 + 参数依赖查找(ADL) |
| 限定名称查找         | `Class::member` 类作用域查找 |
| 非限定名称查找       | 当前作用域向外层逐级查找 |
| as-if 规则           | 允许优化只要可观测行为不变 |
| 未定义行为UB         | 标准未定义行为(如空指针解引用)，结果不可预测 |
| 内存模型             | C++11引入，定义多线程内存访问语义 |
| 多线程执行与数据竞争 | 无同步的并发写导致UB，需`mutex`/原子操作 |
| 字符集与编码         | 基本源字符集 + 执行字符集，支持UTF-8/16/32 |
| 翻译编译阶段         | 1. 字符映射 2. 行拼接 3. 预处理 4. 转义序列处理 5. 拼接字符串 6. 语法分析 7. 模板处理 8. 链接 |
| main函数             | 全局入口函数，`int main(int argc, char* argv[])` |
| 模块                 | C++20引入，替代头文件的编译单元 |
| 合约                 | C++20引入(后移除)，`[[expects: expr]]`前置条件 |

### 关键字

| 关键字                                    | 内容 |
| ----------------------------------------- | ---- |
| 标准关键字                                | `alignas`, `alignof`, `asm`, `auto`, `bool` 等97个 |
| 标识符特殊含义                            | `final`, `override`, `import`, `module` 等上下文关键字 |
| 预处理器关键字                            | `define`, `include`, `ifdef`, `pragma` |
| 替代符号                                  | `and(&&)`, `or(||)`, `not(!)`, `bitand(&)` 等 |
| 预留标识符                                | 双下划线开头或含双下划线的名称 |
| C++11/14/17/20/23/26 各版本中引入新关键字 | `auto`(新义), `constexpr`, `decltype`, `nullptr`(C++11), `concept`, `requires`(C++20), `char8_t`(C++20) |

### 预处理器

| 预处理器                            | 内容 |
| ----------------------------------- | ---- |
| 条件编译指令，C++23新增条件判断指令 | `#if`, `#ifdef`, `#elif`, `#else`, `#endif` + C++23 `#elifdef`/`#elifndef` |
| 宏定义指令，字符串化/粘贴操作       | `#define`, `#undef` + `#`(字符串化), `##`(标记粘贴) |
| 文件包含指令                        | `#include <>`(系统头) / `#include ""`(用户头) |
| 编译器特定指令                      | `#pragma` 编译器扩展(如`#pragma once`) |
| 行号与文件名                        | `#line <num> "filename"` 修改行号/文件名 |
| 错误控制指令，C++23新增警告提示指令 | `#error "msg"` 强制错误 + C++23 `#warning "msg"` |
| 其他控制指令                        | `#`(空指令), `_Pragma`(操作符形式) |

### 表达式

| 表达式       | 内容                                                         |
| ------------ | ------------------------------------------------------------ |
| 值类别       | 左值(有标识可寻址), 右值(可移动), 亡值(将消亡), 纯右值(临时值) |
| 求值顺序     | 序列点规则废除(C++11)，部分有序：`&&`/`||`/`?:`/`,`从左到右, 子表达式 |
| 常量表达式   | `constexpr` 编译时求值表达式 |
| 基本表达式   | `this`, 字面量, 标识符, lambda表达式, `requires`约束, 折叠表达式, 包索引(C++26), 括号分组表达式 |
| 字面量       | 布尔(`true`), 整型(`42`), 浮点(`3.14`), 字符(`'A'`), 字符串(`"str"`), 空指针(`nullptr`), 用户定义(`123_km`)，转义序列 |
| 运算符类别   | 赋值(`=`), 算术(`+`), 自增/自减(`++`), 逻辑(`&&`), 比较(`==`), 位运算(`&`), 成员(`.`/`->`), 函数调用(`()`), 逗号(`,`), 三元(`?:`), 内存管理(`new`/`delete`), 类型查询(`alignof`/`typeid`/`sizeof`), 异常(`noexcept`), 折叠(`... op ...`), 默认比较(`<=>`), 运算符重载 |
| 运算符优先级 | 共19级，如`::`最高, 逗号最低, 结合性 |
| 转换类别     | 隐式(整型提升), 显式(`static_cast`), 用户定义(转换函数), 算术转换, 四种强制类型转换(const_cast，static_cast ，dynamic_cast，reinterpret_cast) |
| 关键概念     | 完整表达式(非子表达式), 可能求值(含运行时), 丢弃值(无副作用), 表达式等价(相同行为) |

### 声明

| 声明       | 内容                                                         |
| ---------- | ------------------------------------------------------------ |
| 声明基础   | 声明语法：`[属性] [说明符] 声明符 [初始化器]`, 冲突声明 |
| 说明符     | 声明规范序列, `typedef`, 函数说明符(`inline`, `virtual`, `explicit`)，`friend`, `consteval`, 类型说明符(简单类型, `class`/`struct`, 联合体, 枚举), `constexpr`, `constinit`, `decltype`, `auto`, `alignas`, `const`, `volatile`, 存储类说明符(`register`, `static`, `extern`, `thread_local`), 类型名限定符, 精炼类型说明符, 打包索引指定符, 属性 |
| 声明符     | 声明器, 数据对象, 标识符,限定名, 参数包, 指针(`*`), 成员指针(`.*`), 引用(`&`/`&&`), 数组(`[]`), 函数(`()`), 分组声明(`(声明符)`) |
| 块声明     | 简单声明(`int x;`), 结构化绑定(`auto [a,b] = t;`), 类型别名声明, `using`声明, `namespace`别名, `static_assert`, `asm`内联汇编, 不透明枚举声明 |
| 其他声明   | 命名空间定义, 函数声明, 类模板, 函数模板, 显式实例化, 显式模板特化, 链接规范(`extern "C"`), 属性(`[[nodiscard]]`), 空声明|
| 声明与定义 | 声明引入名称，定义分配存储或提供函数体 |
| 声明符组合 | 指针+引用(`int*& r`), 数组+函数(`int(*f)(int)[10]`) |

### 初始化

| 初始化           | 内容                   |
| ---------------- | ---------------------- |
| 初始化器         | `=`, `{}`, `()` 等语法形式 |
| 默认初始化       | 无初始化器时：内置类型不定值，类类型调用默认构造 |
| 值初始化         | `T obj{};` 内置类型零值，类类型默认构造 |
| 拷贝初始化       | `T obj = other;` 调用拷贝构造 |
| 直接初始化       | `T obj(arg);` 调用匹配构造 |
| 聚合初始化       | 数组/简单类用`{}`初始化 |
| 列表初始化       | `std::initializer_list` 优先匹配 |
| 引用初始化       | 绑定到左值(左引用)或右值(右引用) |
| 静态初始化       | 编译期初始化(零初始化/常量初始化) |
| 动态非局部初始化 | 跨编译单元初始化顺序问题(有序初始化/无序初始化) |
| 拷贝消除         | 编译器优化省略拷贝/移动操作 |

### 函数

| 函数           | 内容                                       |
| -------------- | ------------------------------------------ |
| 函数声明       | 返回类型 + 函数名 + 参数列表 + 限定符      |
| 函数参数       | 形参声明，默认参数，可变参数(`...`), `va_list` |
| 函数定义       | 声明 + 函数体                              |
| 函数调用       | 实参传递，ADL查找，`operator()`函数调用运算符, 函数对象 |
| 重载           | 相同作用域同名函数，参数列表不同, 重载解析, 运算符重载, 重载函数的地址           |
| 函数协定说明符 | `noexcept`, `throws`(已弃用)               |
| 内联说明符     | `inline` 建议编译器内联展开                |
| Lambda 表达式  | `[捕获](参数) -> ret { 函数体 }` 匿名函数  |
| 协程           | C++20引入，`co_await`, `co_yield` 关键字   |
| 替代函数       | `if constexpr` 编译时分支替代方案          |

### 语句

| 语句       | 内容 |
| ---------- | ---- |
| 标签语句   | `label:` (goto目标), `case:` (switch分支) |
| 表达式语句 | 表达式后跟`;` (如`x++;`) |
| 复合语句   | `{...}` 代码块，创建作用域 |
| 选择语句   | `if/else`, `switch/case/default` |
| 迭代语句   | `for`, `range-for`, `while`, `do-while` |
| 跳转语句   | `break`, `continue`, `goto`, `return` |
| 断言语句   | `assert` 运行时检查 |
| 声明语句   | 块内声明变量 |
| try 块     | `try {...} catch(...) {...}` 异常处理 |
| 事务内存   | C++20实验特性，`synchronized`原子块 |

### 类

| 类           | 内容                                                         |
| ------------ | ------------------------------------------------------------ |
| 基础概述     | `class`/`struct`(默认public), `union`(共享内存), 注入类名(类内可用简名) |
| 类的属性     | 类属性规范, 平凡可复制(可memcpy), 平凡(默认构造), 标准布局(兼容C), 隐式生命周期类, POD(平凡+标准布局) |
| 成员         | 数据成员, 静态成员, 嵌套类, 成员模板, 位字段, `using` 声明, `this` 指针, 成员函数, 访问说明符(`public`/`protected`/`private`), 默认成员初始值设定项, `mutable`, `friend`, `explicit` |
| 特殊成员函数 | 构造函数和成员初始值设定项列表, 默认构造函数, 拷贝构造函数, 移动构造函数, 拷贝赋值运算符, 移动赋值运算符, 转换构造函数, 析构函数 |
| 继承         | 基类和派生类, 抽象类, 空基类优化, 虚继承, 虚函数(`virtual`), 纯虚函数(`=0`), `override`/`final` |

### 模板

| 模板       | 内容                                            |
| ---------- | ----------------------------------------------- |
| 基础模板   | `template<typename T>`, 类模板/函数模板/类成员模板/变量模板(C++14) |
| 参数       | 类型参数, 非类型参数, 模板参数推导, 类模板参数推导(C++17) |
| 特化       | 显式特化, 部分特化(仅类模板)                    |
| 参数包     | 包, 可变模板参数, `template<typename... Ts>`, `sizeof...`, 折叠表达式(C++17), 包索引 |
| 依赖名称   | 名称查找, `typename` 消除歧义, SFINAE(替换失败非错误)     |
| 约束和概念 | C++20 `concept` 定义约束, `requires` 子句       |

### 异常

| 异常           | 内容                                         |
| -------------- | -------------------------------------------- |
| 异常对象       | `throw` 创建异常对象并传递                   |
| 异常使用       | `try` 监控代码块, `catch` 按类型捕获处理     |
| 异常安全       | 基本/强/无异常保证                           |
| 异常规范       | `noexcept` 规范与说明符, 动态异常规范  |
| constexpr 异常 | C++20 允许 `constexpr` 函数中 `throw`        |

### 杂项和习语

| 杂项和习语              | 内容                                                  |
| ----------------------- | ----------------------------------------------------- |
| 好奇反复模板模式(CRTP)  | 派生类作为基类模板参数                                |
| 实现指针(PIMPL)         | 前置声明实现类，隐藏实现细节                          |
| 资源获取即初始化(RAII)  | 构造函数获取资源，析构函数释放                        |
| 三法则/五法则/零法则    | 特殊成员函数管理规则                                  |
| 零开销原则              | 不使用则不付出成本，使用时高效                        |
| C++的历史               | C with Classes→C++98→C++11→C++14→C++17→C++20→C++23    |
| 扩展 std 命名空间       | 禁止用户直接添加，需特化`std`中模板                   |
| 缩写                    | RAII(资源获取即初始化), TMP(模板元编程), SFINAE(替换失败非错误), NTTP(非类型模板参数) |
