# C++ 参考手册

- [C++ 参考手册](#c-参考手册)
  - [语言标准](#语言标准)
  - [编译器支持](#编译器支持)
  - [语言概念](#语言概念)
  - [标准库头文件](#标准库头文件)
  - [命名要求](#命名要求)
  - [功能测试](#功能测试)
  - [技术规格](#技术规格)
  - [有用资源](#有用资源)

---

## 语言标准

**C++98** 是 C++ 语言的第一个正式标准，由 ISO 于 1998 年发布。它奠定了现代 C++ 的基础，引入了许多重要的特性，如 STL（标准模板库）、模板、异常处理、命名空间等。C++98 的发布标志着 C++ 成为一门成熟的编程语言。

**C++03** 是对 C++98 的一次小幅修订，主要修复了一些小错误和不一致之处，未引入新的语言特性。它的目标是确保 C++98 的稳定性和一致性。

**C++11** 是 C++ 发展史上的一个重要里程碑，被称为“现代 C++”的起点。它引入了许多新特性，极大地增强了语言的功能性和表达能力，包括：自动类型推导（`auto`）、范围 for 循环、Lambda 表达式、右值引用和移动语义、智能指针（`std::unique_ptr`、`std::shared_ptr`）、并发支持（`std::thread`、`std::mutex`）、统一初始化语法（`{}`）、`nullptr` 替代 `NULL`、`constexpr` 和 `noexcept` 关键字。

**C++14** 是对 C++11 的一次小幅修订，主要增强了已有特性，如：泛型 Lambda 表达式、返回类型推导（`auto`）、二进制字面量、数字分隔符（`'`）。

**C++17** 专注于提高语言和库的实用性，引入了许多实用的新特性，如：结构化绑定（`auto [x, y] = make_pair(1, 2);`）、`if constexpr`（编译时条件判断）、`std::optional`、`std::variant`、`std::any`、文件系统库（`<filesystem>`）、并行算法（`std::execution`）。

**C++20** 是一个革命性的版本，引入了许多重大新特性，旨在提高 C++ 的表达能力、性能和易用性，包括：概念（Concepts）、范围（Ranges）、协程（Coroutines）、模块（Modules）、三向比较运算符（`<=>`）、`std::format`（格式化库）。

**C++23** 是一个持续发展的标准，专注于完善和增强现有特性。它引入了一些新特性，如：`std::print`（更简单的打印函数）、`std::expected`（错误处理）、`std::mdspan`（多维视图）、改进的 `std::format`。

**C++26** 是下一代 C++ 标准，仍在开发中。预计将进一步增强语言的功能性和表达能力，如：合约（Contracts）、更强大的模块支持、改进的协程支持。

---

## 编译器支持

**GCC** 是一个开源的编译器套件，支持多种编程语言，包括 C 和 C++。它对 C++ 标准的支持非常全面，尤其是对 C++11、C++14、C++17 和 C++20 的支持较为成熟。GCC 还提供了许多扩展功能，如内联汇编、属性声明等。

**Clang** 是 **LLVM** 项目的一部分，以其快速编译速度和优秀的错误提示而闻名。它对 C++ 标准的支持也非常出色，尤其是在 C++11、C++14、C++17 和 C++20 方面表现优异。Clang 的设计目标是替代 GCC，成为下一代主流编译器。

**MSVC** 是微软开发的 C/C++ 编译器，主要用于 Windows 平台。虽然它对 C++11 的支持相对较晚，但在 C++14、C++17 和 C++20 方面已经逐步完善。MSVC 提供了丰富的调试工具和集成开发环境（IDE），适合 Windows 开发者使用。

---

## 语言概念

**基础概念**：注释用于代码说明，ASCII编码定义字符表示，标点符号构成语法结构，名称与标识符命名实体，类型定义数据类别，基本类型包括整型/浮点型等内置类型，对象指存储区域实例，作用域限定名称可见性，对象生存期控制资源有效性，存储持续期与链接性管理内存周期和跨文件访问，定义与ODR（单一定义规则）确保全局唯一性，名称查找解析标识符含义，限定名称查找通过作用域运算符::定位，非限定名称查找依赖当前作用域，as-if规则允许编译器优化不影响行为的代码，未定义行为表示标准未规定的错误操作，内存模型定义多线程内存访问语义，多线程执行与数据竞争(C++11)规范并发编程，字符集与编码处理文本表示，翻译编译阶段描述源码到二进制过程，main函数是程序入口点，模块(C++20)提供组件化封装，合约(C++26)支持前置/后置条件检查。

**关键字**：标准关键字（如if/class）具有语法功能，标识符特殊含义（如override）增强语义，预处理器关键字（如#define）在编译前处理，替代符号（如and代替&&）提供别名，预留标识符（以双下划线开头）供实现使用，C++11/14/17/20引入新关键字（如constexpr/requires）扩展功能。

**预处理器**：条件编译指令（#ifdef）控制代码包含，宏定义指令（#define）实现文本替换，文件包含指令（#include）插入头文件，错误控制指令（#error）中断编译，其他控制指令（#line）调整行号记录。

**表达式**：通用概念包括值类别（左值/右值），字面量（如42/3.14）直接表示值，运算符（如+/-）执行操作，转换机制（隐式/显式）处理类型转换，内存管理类（new/delete）分配资源，其他特性（如常量表达式），主表达式（变量/字面量）为基本单元，完整表达式构成语句，丢弃值表达式（如函数返回void）忽略结果，潜在评估表达式可能运行时求值，表达式等价性指语义相同。

**声明**：声明语法（如`int x;`）引入名称，说明符（如const）修饰类型，声明符（如*／&）定义指针/引用，简单声明单次声明变量，特殊声明（如函数声明），块声明在作用域内有效，模板声明泛型代码，属性声明（[[noreturn]]）附加信息，空声明（;）无作用，其他声明（如命名空间）。

**初始化**：初始值设定项（如`int x{5};`）提供初始值，非局部变量（全局/静态）在main前初始化，默认初始化内置类型不确定而类类型调用默认构造函数，值初始化内置类型置零，直接初始化调用构造函数，拷贝初始化用=语法，列表初始化（C++11）支持花括号语法，聚合初始化初始化数组/结构体，引用初始化必须绑定对象，复制省略（C++17强制）避免临时对象拷贝，静态初始化编译期初始化常量，动态非本地初始化依赖顺序可能问题，类成员初始化在构造函数中完成。

**函数**：函数声明描述签名，函数参数列表定义输入，函数定义实现逻辑，函数协定说明符（C++26）指定行为约束，默认参数提供缺省值，可变参数（如va_list）处理不定参数，内联说明符建议编译器内联展开，Lambda表达式（C++11）定义匿名函数对象，协程（C++20）支持异步操作，替换函数（如operator new）可自定义，函数调用执行代码，参数依赖查找（ADL）在参数命名空间查找函数，函数调用运算符（operator()）使对象可调用，函数对象重载多个operator()，重载解决选择最佳匹配函数，操作符重载（如+）自定义运算符行为，重载集的地址获取特定重载版本地址。

**语句**：标签语句（如goto标签）标记位置，表达式语句（如赋值）执行表达式，复合语句（{}）组合多条语句，选择语句（if/switch）条件分支，迭代语句（for/while）循环执行，跳转语句（break/return）控制流转移，断言语句（assert）检查条件，声明语句引入变量，try块捕获异常，事务内存（TS扩展）提供原子操作组。

**类**：类/结构体定义数据类型，联合体共享内存布局，注入类名（如在类内可直接用类名）简化代码，类属性（C++26）附加元数据，数据成员存储状态，静态成员类级别共享，this指针指向当前实例，嵌套类定义在类内部，成员模板泛化类成员，位字段（如`int b:3;`）节省内存，使用声明（using）引入名称，成员函数定义操作，成员访问说明符（public/private）控制封装，构造函数初始化对象，成员初始值设定项列表直接初始化成员，默认成员初始值设定项（C++11）提供类内默认值，友元说明符授权外部访问，显式说明符禁止隐式转换，转换构造函数定义类型转换，特殊成员函数（构造/析构等）自动生成，默认构造函数无参构造，复制构造函数拷贝对象，移动构造函数（C++11）转移资源，复制赋值运算符赋值拷贝，移动赋值运算符（C++11）赋值转移，析构函数释放资源，继承实现派生类，基类和派生类构成层次，空基优化（EBO）避免空基类占用内存，虚成员函数支持多态，纯虚函数定义接口，覆盖说明符（override）显式标记重写，最终说明符（final）禁止进一步重写。

**模板**：模板参数（类型/非类型/模板）泛化代码，类模板（如vector）定义泛型类，函数模板（如sort）定义泛型函数，类成员模板类内模板，变量模板（C++14）泛型变量，模板参数推演自动推导类型，类模板参数推导（C++17）省略模板参数，显式（完整）模板特化定制特定版本，部分模板特化部分定制，依赖名称依赖于模板参数，包（C++11）表示参数包，sizeof...（C++11）计算包大小，折叠表达式（C++17）简化包展开，包索引（C++26）访问包元素，SFINAE约束模板重载，约束和概念（C++20）简化模板要求，requires表达式（C++20）定义约束条件。

**异常**：异常处理错误，异常对象存储异常信息，try块捕获异常，throw抛出异常，catch处理异常，异常规范（已弃用）指定可能抛出类型，noexcept规范（C++11）声明不抛异常，动态规范（C++17前）运行时检查，noexcept运算符（C++11）查询表达式是否不抛异常，constexpr异常（C++26）允许异常在编译期处理。

**杂项和习语**：C++历史经历多次标准迭代，扩展命名空间std添加标准库组件，首字母缩略词（如RAII）总结惯用法，ASM声明嵌入汇编代码，自立式实现（如嵌入式）无操作系统支持，宿主式实现（如Windows）依赖OS，CRTP实现静态多态，PIMPL隐藏实现细节，RAII管理资源生命周期，三/五/零规则指导资源管理类设计，零开销原则不牺牲性能。

---

## 标准库头文件

**语言支持库**：提供核心语言功能的实现支持，包括类型支持（如`<type_traits>`）、程序实用工具（如`<utility>`）、动态内存管理（如`<new>`）、错误处理（如`<exception>`）、可变参数处理（如`<cstdarg>`）、元编程（C++11的`<type_traits>`扩展）、常量求值上下文（C++20的`<consteval>`）、初始化列表（C++11的`<initializer_list>`）、源代码信息捕获（C++20的`<source_location>`）、三向比较（C++20的`<compare>`）、协程支持（C++20的`<coroutine>`）和合约支持（C++26的`<contract>`）。

**概念库**：定义标准库概念（C++20的`<concepts>`），包括隐式表达式变体（如`same_as`）、输出相等（如`equality_comparable`）、核心语言概念（如`derived_from`）、对象生命周期概念（如`destructible`）、比较概念（如`strict_weak_order`）、对象概念（如`movable`）和可调用概念（如`invocable`）。

**诊断库**：提供异常处理（如`<exception>`）、异常类别（如`std::runtime_error`）、错误编号（如`<system_error>`）、系统错误（如`std::error_code`）、断言（如`<cassert>`）、堆栈跟踪（调试支持）和调试工具（如`<debugging>`）。

**内存管理库**：包含分配器（如`<memory>`）、未初始化内存算法（如`uninitialized_copy`）、受约束的未初始化算法（C++20的`<memory>`扩展）、内存资源（C++17的`<memory_resource>`）、显式生命周期管理（C++23的`<memory>`）、垃圾回收支持（如`<gc>`）、智能指针（如`unique_ptr`）、低级内存管理（如`<cstdlib>`的`malloc`）和C库兼容功能。

**元编程库**：提供类型特征（`<type_traits>`）、类型属性查询（如`alignment_of`）、类型关系（如`is_base_of`）、类型修改（如`add_const`）、类型转换（如`common_type`）、编译期整数序列（如`integer_sequence`）和编译期有理数运算（如`<ratio>`）。

**通用实用程序库**：包含交换操作（`std::swap`）、类型操作（如`std::move`）、整数比较函数（C++20的`cmp_less`）、关系运算符（如`std::strong_ordering`）、构造标签（如`std::in_place`）、对和元组（`<tuple>`）、和类型（如`std::variant`）、位集（`<bitset>`）、位操作（C++20的`<bit>`）、函数对象（如`std::function`）、哈希支持（`<functional>`）和常见词汇类型（如`std::optional`）。

**容器库**：提供节点句柄（C++17的`node_handle`）、序列容器（如`vector`）、关联容器（如`map`）、无序关联容器（如`unordered_set`）、容器适配器（如`stack`）、视图（如`std::span`）、迭代器失效规则说明、线程安全保证和函数表（如`std::map`用于动态分发）。

**迭代器库**：定义迭代器概念（C++20的`<iterator>`）、迭代器基元（如`iterator_traits`）、迭代器自定义点（如`iter_swap`）、算法概念和实用程序、流迭代器（如`istream_iterator`）、迭代器适配器（如`reverse_iterator`）和迭代器操作（如`distance`）。

**范围库**：提供范围访问（如`ranges::begin`）、范围基元（如`range_value_t`）、范围转换（如`views::transform`）、悬空迭代器处理、范围概念（如`range`）、视图（如`views::filter`）、范围工厂（如`views::iota`）、范围适配器（如`|`操作符）和范围适配器对象。

**算法库**：包含约束算法和范围算法（C++20的`<algorithm>`）、执行策略（如`std::execution::par`）、非修改序列操作（如`all_of`）、修改序列操作（如`copy`）、排序操作（如`sort`）、数值操作（如`reduce`）、未初始化内存操作（如`uninitialized_fill`）和C库算法（如`qsort`）。

**字符串库**：提供字符类型（如`char16_t`）、字符串类（如`std::string`）、字符串视图类（C++17的`std::string_view`）和相关库（如正则表达式`<regex>`）。

**文本处理库**：包含本地化库（`<locale>`）、正则表达式库（`<regex>`）、格式化库（C++20的`<format>`）、以空字符结尾的序列工具（如`<cstring>`）、基本数值转换（C++17的`from_chars`）和文本编码标识（如`std::text_encoding`）。

**数字库**：提供常用数学函数（如`<cmath>`）、数学特殊函数（C++17的`<cmath>`扩展）、数学常数（C++20的`<numbers>`）、线性代数算法（C++26的`<linalg>`）、数据并行类型（如`std::simd`）、浮点环境（`<cfenv>`）、复数运算（`<complex>`）、伪随机数生成（`<random>`）、位操作（`<bit>`）和饱和算术（C++26的`<numeric>`）。

**日期和时间库**：包含chrono库（C++11的`<chrono>`）、C风格日期时间（`<ctime>`）、时间点（如`time_point`）、持续时间（如`seconds`）、时钟（如`system_clock`）、日历（C++20的`<chrono>`）、时区（C++20的`<chrono>`）和字面量（如`24h`）。

**输入/输出库**：提供I/O操作器（如`std::hex`）、打印函数（C++23的`print`）、C风格I/O（`<cstdio>`）、缓冲区（如`streambuf`）、基于流的I/O（如`iostream`）、文件I/O（`<fstream>`）、字符串I/O（`<sstream>`）、同步输出（C++20的`<syncstream>`）和预定义标准流对象（如`std::cout`）。

**并发支持库**：包含线程管理（`<thread>`）、协作取消（C++20的`<stop_token>`）、缓存大小访问（C++17的`<new>`）、互斥锁（如`mutex`）、条件变量（`<condition_variable>`）、信号量（C++20的`<semaphore>`）、门闩和屏障（C++20的`<latch>`）、期程（C++23的`<future>`）、原子类型（`<atomic>`）和内存排序（如`memory_order`）。

**执行控制库**：提供执行概念（C++23的`<execution>`）、实用组件（如`sender`/`receiver`）、核心操作（如`connect`）和发送者算法（如`then`）。发送者/接收者模型（C++23）统一异步操作。

**C 兼容标头**：包括C风格头文件（如`<stdlib.h>`）和C++风格包装头（如`<cstdlib>`），后者将C库函数放入`std`命名空间。C++头文件优势`<cstdio>`的`std::printf`避免全局命名空间污染，而`<stdio.h>`的`::printf`可能冲突。

---

## 命名要求

**基本要求**：基本要求是指命名的基本规则，如标识符必须以字母或下划线开头，后面可以跟字母、数字或下划线。

**类型属性**：类型属性是指类型的特性，如是否为整型、浮点型、指针类型等。

**库级要求**：库级要求是指库的特性，如是否支持多线程、是否支持异常等。

**容器要求**：容器要求是指容器的特性，如是否支持随机访问、是否支持插入和删除等。

**迭代器要求**：迭代器要求是指迭代器的特性，如是否支持前向迭代、是否支持双向迭代等。

**流I/O要求**：流I/O要求是指流I/O的特性，如是否支持格式化输入输出、是否支持缓冲等。

**格式化要求**（C++20）：格式化要求是指格式化的特性，如是否支持格式化字符串、是否支持格式化参数等。

**随机数生成要求**：随机数生成要求是指随机数生成的特性，如是否支持伪随机数生成、是否支持真随机数生成等。

**并发要求**：并发要求是指并发的特性，如是否支持多线程、是否支持同步等。

**范围要求**（C++20）：范围要求是指范围的特性，如是否支持范围访问、是否支持范围转换等。

**多维视图定制**（C++23）：多维视图定制是指多维视图的特性，如是否支持多维视图、是否支持多维视图定制等。

**其他要求**：其他要求是指其他未列出的特性。

---

## 功能测试

**属性特性测试**：属性特性测试用于检测编译器是否支持某些属性，如 `[[noreturn]]`、`[[deprecated]]` 等。

**语言特性测试**：语言特性测试用于检测编译器是否支持某些语言特性，如 `auto`、`constexpr`、`noexcept` 等。

**库特性测试**：库特性测试用于检测编译器是否支持某些库特性，如 `std::optional`、`std::variant`、`std::any` 等。

**编译器功能转储**：编译器功能转储用于获取编译器支持的所有功能列表。

---

## 技术规格

**标准库扩展**：标准库扩展是指对标准库的扩展，如增加新的容器、算法等。

**并行度库扩展**：并行度库扩展是指对并行度库的扩展，如增加新的并行算法等。

**并发库扩展**：并发库扩展是指对并发库的扩展，如增加新的并发工具等。

**事务内存**（TM TS）：事务内存是指支持事务性操作的内存管理技术。

**概念**（概念 TS）：概念是指用于限制模板参数的类型。

**范围**（范围 TS）：范围是指用于处理范围数据的技术。

**协程**（协程 TS）：协程是指用于实现异步编程的技术。

**网络**（网络 TS）：网络是指用于处理网络通信的技术。

**模块**（模块 TS）：模块是指用于替代传统头文件机制的技术。

**反射**（反射 TS）：反射是指用于在运行时获取类型信息的技术。

**TR/TS 规格**：TR/TS 规格是指技术报告和技术规范，用于描述实验性的或尚未正式纳入标准的功能。

**非 TS 提案**：非 TS 提案是指尚未被正式纳入标准但正在讨论中的提案。

---

## 有用资源

**标准 C++ 基金会**：是一个非营利组织，致力于推广和维护 C++ 标准。它提供了 C++ FAQ 和 isocpp.org 网站，是学习 C++ 的重要资源。

**C++ 常见问题解答**：包括 Bjarne Stroustrup FAQ、Bjarne Stroustrup C++11 FAQ 和 StackOverflow.com C++ FAQ，涵盖了 C++ 的常见问题和解决方案。

**C++ 标准文档和草案**：包括 JTC1/SC22/WG21、cplusplus/draft 和 eel.is/c++draft，提供了 C++ 标准的官方文档和最新草案。

**C++ 语言和库参考**：包括商业实现参考、开源实现参考和社区资源，提供了 C++ 语言和库的详细参考。

**C++ ABI**：包括 Itanium C++ ABI、System V ABI 和 ARM C++ ABI，定义了 C++ 程序如何与操作系统交互。

**模式、习语、提示和技巧**：包括 C++ Core Guidelines、C++ Patterns、More C++ Idioms、CeePlusPlusIdioms和Welcome Back to C++，提供了 C++ 编程的最佳实践和技巧。

**相关标准**：包括 JTC1/SC22/WG14、POSIX.1-2024/IEEE Std 1003.1-2024 和 The Unicode Standard，提供了与 C++ 相关的其他标准。

**非 ANSI/ISO C++ 库列表**：包括包管理器和开源库，提供了 C++ 的第三方库资源。

---

来源：[cppreference.com](https://en.cppreference.com/index.html)
