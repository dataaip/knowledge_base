# C 编译器支持权威详解

> 本文档系统梳理了 C 语言 C99 与 C23 标准的主流编译器支持情况，并对各核心语言特性进行权威扩展说明与举例。内容参考 cppreference.com，结合实际工程经验，确保准确、实用、可查。

---

## 目录
- [C23 特性与编译器支持](#c23-特性与编译器支持)
- [C99 特性与编译器支持](#c99-特性与编译器支持)
- [常见问题与权威解答](#常见问题与权威解答)
- [参考资料](#参考资料)

---

## C23 特性与编译器支持

> C23 是 C 语言最新标准，持续完善现代化特性。下表展示主流编译器对 C23 关键特性的支持情况。

### C23 核心语言特性支持表

| 特性 | 相关论文 | GCC | Clang | MSVC | Apple Clang | EDG eccp | Intel C++ | Nvidia HPC C++ | Nvidia nvcc | Cray |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 不带消息的 static_assert | N2265 | 9 | 9 | Yes | Yes | 6.5 | 2021.1.2 |  |  |  |
| `[[nodiscard]]` | N2267 | 10 | 9 |  | Yes | 6.4 | 2021.1.2 |  |  |  |
| `[[maybe_unused]]` | N2270 | 10 | 9 |  | Yes | 6.4 | 2021.1.2 |  |  |  |
| `[[deprecated]]` | N2334 | 10 | 9 |  | Yes | 6.4 | 2021.1.2 |  |  |  |
| 属性 (Attributes) | N2335 N2554 | 10 | 9 |  | Yes | 6.4 | 2021.1.2 |  |  |  |
| IEEE 754 十进制浮点类型 | N2341 | 4.2 (部分) 12 |  |  |  |  | 13.0 (部分) |  |  |  |
| `[[fallthrough]]` | N2408 | 10 | 9 |  | Yes | 6.4 | 2021.1.2 |  |  |  |
| `u8` 字符常量 | N2418 | 10 | 15 |  |  | 6.5 | 2022.2 |  |  |  |
| 移除无原型的函数定义 | N2432 | 10 | 15 |  |  |  | 2022.2 |  |  |  |
| 带消息的 `[[nodiscard]]` | N2448 | 11 | 10 |  | Yes | 6.4 | 2021.1.2 |  |  |  |
| 函数定义中的匿名参数 | N2480 | 11 | 11 |  | Yes | 6.4 | 2021.1.2 |  |  |  |
| 标签可在声明前或块末尾 | N2508 | 11 | 16 | 部分 |  | 6.5 | 17.0 |  |  |  |
| 二进制整数常量 | N2549 | 4.3 11 | 2.9 9 | 19.0 (2015) ** | Yes | 6.5 | 11.0 |  |  |  |
| 预处理器条件中的 `__has_c_attribute` | N2553 | 11 | 9 |  | Yes | 6.5 | 2021.1.2 |  |  |  |
| 允许重复属性 | N2557 | 11 | 13 |  | Yes | 6.5 | 基于 clang 的 2021.4 |  |  |  |
| IEEE 754 交换与扩展类型 | N2601 | 7 (部分) 14 | 6 (部分) |  | 部分 |  |  |  |  |  |
| 数字分隔符 | N2626 | 12 | 13 | 19.0 (2015) ** | Yes | 6.5 | 18.0 |  |  |  |
| `#elifdef` 和 `#elifndef` | N2645 | 12 | 13 | 19.40 | 13.1.6 | 6.5 | 2021.4 |  |  |  |
| `u8` 字符串字面量的类型修改 | N2653 | 13 |  |  |  |  |  |  |  |  |
| 支持标签的 `[[maybe_unused]]` | N2662 | 11 | 16 |  |  | 6.5 | 2022.2 |  |  |  |
| #warning | N2686 | Yes | Yes |  | Yes | 6.5 | Yes |  |  |  |
| 位精确整数类型 (_BitInt) | N2763 | 14 (部分) | 15 |  |  | 6.5 | 2022.2 |  |  |  |
| `[[noreturn]]` | N2764 | 13 | 15 |  |  | 6.5 | 2022.2 |  |  |  |
| 位精确整数常量后缀 | N2775 | 14 | 15 |  |  |  | 2022.2 |  |  |  |
| 预处理器条件中的 `__has_include` | N2799 | 5 | Yes | 19.11 | Yes | 6.5 | 18.0 |  |  |  |
| 使用 Unicode 标准附件 31 的标识符语法 | N2836 | 13 | 15 |  |  | 6.5 | 2022.2 |  |  |  |
| 移除无原型的函数声明 | N2841 | 13 | 15 |  |  |  | 2022.2 |  |  |  |
| 空初始化器 | N2900 | 部分 13 | 部分 |  | 部分 | 部分 | 部分 |  |  | 部分 |
| typeof 和 typeof_unqual | N2927 N2930 | 部分 13 | 部分 16 | 19.39 | 部分 | 部分 | 部分 |  |  | 部分 |
| 新关键字拼写 | N2934 | 13 | 16 |  |  | 6.5 |  |  |  |  |
| 预定义的 true 和 false | N2935 | 13 | 15 |  |  |  | 2022.2 |  |  |  |
| `[[unsequenced]]` 和 `[[reproducible]]` | N2956 | 15 |  |  |  |  |  |  |  |  |
| 放宽可变参数列表的要求 | N2975 | 13 | 16 |  |  | 6.5 | 2023.1 |  |  |  |
| 对象定义中的类型推断 | N3007 | 13 | 18 |  |  |  |  |  |  |  |
| #embed | N3017 | 15 | 19 |  |  |  |  |  |  |  |
| constexpr 对象 | N3018 | 13 | 19 |  |  |  |  |  |  |  |
| 改进的枚举 | N3029 | 13 | 20 |  |  |  |  |  |  |  |
| 具有固定底层类型的枚举 | N3030 | 13 | 20 |  |  |  |  |  |  |  |
| `__VA_OPT__` | N3033 | 8 13 | 12 | 19.39 |  | 6.5 |  |  |  |  |
| 复合字面量的存储类说明符 | N3038 | 13 |  |  |  |  |  |  |  |  |
| nullptr | N3042 | 13 | 16 |  |  |  |  |  |  |  |
| C23 特性 | 相关论文 | GCC | Clang | MSVC | Apple Clang | EDG eccp | Intel C++ | Nvidia HPC C++ (前身为 PGI)\* | Nvidia nvcc | Cray |

### C23 重要特性权威详解

#### 1. static_assert（无消息）
- 用于编译期断言，若条件不成立则编译失败。
- 语法更简洁，无需提供错误消息。
- **示例：**
  ```c
  static_assert(sizeof(int) == 4);
  ```

#### 2. [[nodiscard]]
- 标记函数返回值不可忽略，提升代码安全性。
- **示例：**
  ```c
  [[nodiscard]] int calc();
  void f() { calc(); /* 编译警告 */ }
  ```

#### 3. [[maybe_unused]]
- 标记变量/函数可能未被使用，避免编译警告。
- **示例：**
  ```c
  [[maybe_unused]] int debug = 1;
  ```

#### 4. [[deprecated]]
- 标记弃用接口，编译器发出警告。
- **示例：**
  ```c
  [[deprecated("Use new_func instead")]] void old_func();
  ```

#### 5. 属性（Attributes）
- 标准化元数据注解，便于优化与静态分析。
- **示例：**
  ```c
  [[gnu::always_inline]] inline void fast();
  ```

#### 6. u8 字符常量
- 支持 UTF-8 字符常量，提升国际化能力。
- **示例：**
  ```c
  char c = u8'A';
  ```

#### 7. 二进制整数常量
- 允许直接用 0b 前缀表示二进制数。
- **示例：**
  ```c
  int mask = 0b10101010;
  ```

#### 8. #elifdef/#elifndef
- 预处理器增强，支持更灵活的条件编译。
- **示例：**
  ```c
  #ifdef A
  #elifdef B
  #endif
  ```

#### 9. nullptr
- 引入类型安全的空指针字面量。
- **示例：**
  ```c
  int *p = nullptr;
  ```

#### 10. typeof/typeof_unqual
- 类型推导关键字，便于泛型编程。
- **示例：**
  ```c
  typeof(1+2.0) x = 3.0;
  ```

#### 11. 预定义 true/false
- 布尔值成为内建关键字。
- **示例：**
  ```c
  bool flag = true;
  ```

#### 12. constexpr 对象
- 支持编译期常量对象，提升性能。
- **示例：**
  ```c
  constexpr int N = 10;
  ```

---

## C99 特性与编译器支持

> C99 是 C 语言现代化的重要里程碑，极大丰富了语法与类型系统。下表展示主流编译器对 C99 关键特性的支持情况。

### C99 核心语言特性支持表

| 特性 | 相关论文 | GCC | Clang | MSVC | Apple Clang | EDG eccp | Intel C++ | Nvidia HPC C++ | Nvidia nvcc | Cray |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 标识符中的通用字符名称 |  | 3.1 | Yes | Yes |  |  |  |  |  |  |
| // 注释 | N644 | 2.7 | Yes | Yes |  |  |  |  |  |  |
| restrict 指针 | N448 | 2.95 | Yes | 部分 |  |  |  |  |  |  |
| 灵活数组成员 |  | 3.0 | Yes | Yes |  |  |  |  |  |  |
| 可变长度数组 (VLA) | N683 | 0.9 | Yes |  |  |  |  |  |  |  |
| 指定初始化器 | N494 | 3.0 | Yes | Yes |  |  |  |  |  |  |
| 复合字面量 | N716 | 3.1 | Yes | Yes |  |  |  |  |  |  |
| 浮点环境 |  | 部分 | 部分 |  |  |  |  |  |  |  |
| 要求对有符号整数除法进行截断 | N617 | 0.9 | N/A |  |  |  |  |  |  |  |
| main() 函数中的隐式返回 0 |  | Yes | Yes | Yes |  |  |  |  |  |  |
| 声明和语句混合顺序 | N740 | 3.0 | Yes | Yes |  |  |  |  |  |  |
| for 循环中的 init-statement |  | Yes | Yes | Yes |  |  |  |  |  |  |
| 内联函数 | N741 | 4.3 | Yes | Yes |  |  |  |  |  |  |
| 预定义变量 __func__ | N611 | 2.95 | Yes | Yes |  |  |  |  |  |  |
| 函数声明中 [] 内的 cvr 限定符和 static |  | 3.1 | Yes |  |  |  |  |  |  |  |
| 可变参数宏 | N707 | 2.95 | Yes | Yes |  |  |  |  |  |  |
| _Pragma 预处理器操作符 | N634 | 3.0 | Yes | 部分 |  |  |  |  |  |  |
| 标准浮点评估指令 | N631 N696 | No | No |  |  |  |  |  |  |  |
| C99 特性 | 相关论文 | GCC | Clang | MSVC | Apple Clang | EDG eccp | Intel C++ | Nvidia HPC C++ (前身为 PGI)\* | Nvidia nvcc | Cray |

### C99 重要特性权威详解

#### 1. Universal-character-names in identifiers
- 标识符支持 Unicode，便于国际化。
- **示例：**
  ```c
  int \u03A9; // 希腊字母欧米伽
  ```

#### 2. // 注释
- 支持 C++ 风格单行注释。
- **示例：**
  ```c
  // 这是注释
  ```

#### 3. restrict 指针
- 优化指针别名分析，提升性能。
- **示例：**
  ```c
  void f(int *restrict a, int *restrict b);
  ```

#### 4. 灵活数组成员
- 结构体最后成员可为不定长数组。
- **示例：**
  ```c
  struct S { int n; char data[]; };
  ```

#### 5. 可变长度数组 (VLA)
- 运行时确定数组长度。
- **示例：**
  ```c
  void f(int n) { int arr[n]; }
  ```

#### 6. 指定初始化器
- 按成员名初始化结构体。
- **示例：**
  ```c
  struct P { int x, y; } p = { .y=2, .x=1 };
  ```

#### 7. 复合字面量
- 支持匿名数组/结构体。
- **示例：**
  ```c
  int *p = (int[]){1,2,3};
  ```

#### 8. inline 函数
- 建议编译器内联展开。
- **示例：**
  ```c
  inline int sq(int x) { return x*x; }
  ```

#### 9. __func__ 预定义变量
- 自动记录当前函数名。
- **示例：**
  ```c
  void f() { printf("%s", __func__); }
  ```

---

## 常见问题与权威解答

- **Q: C23/C99 新特性是否所有主流编译器都支持？**
  - A: 绝大多数新特性已被 GCC/Clang/MSVC 等主流编译器支持，但部分特性需较新版本。
- **Q: C23/C99 特性能否混用？**
  - A: C23 是 C99 的超集，绝大多数 C99 代码可直接在 C23 模式下编译。
- **Q: 如何选择编译器和标准？**
  - A: 推荐优先使用支持最新标准的主流编译器，并根据项目需求选择标准。

---

## 参考资料
- [cppreference.com C 编译器支持](https://en.cppreference.com/w/c/compiler_support)
- [ISO/IEC 9899 各版本官方文档](https://www.open-std.org/jtc1/sc22/wg14/)
- GCC/Clang/MSVC 官方文档

---

> 本文档内容持续更新，欢迎查阅最新标准与编译器文档以获取最权威信息。