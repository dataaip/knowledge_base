# C 语言概念

### 基础概念

| 基础概念           | 内容 |
| ------------------ | ---- |
| 注释               | 单行(`//`)、多行(`/* */`)，预处理前被空格替换 |
| ASCII编码          | 7位字符编码标准(0-127)，基础字符集实现 |
| 字符集             | 基本源字符集(字母/数字/标点) + 执行字符集 |
| 翻译阶段           | 1. 字符映射 2. 行拼接 3. 预处理 4. 转义序列处理 5. 拼接字符串 6. 语法分析 7. 链接 |
| 标点符号           | 运算符外的语法符号(`[]`, `{}`, `;`, `,`等) |
| 标识符             | 字母/数字/下划线组成，区分大小写，非数字开头 |
| 作用域             | 块作用域、文件作用域、函数作用域、函数原型作用域 |
| 生命周期           | 自动存储期(栈)、静态存储期(全局)、线程存储期(`_Thread_local`)、动态分配(堆) |
| 名称查找与命名空间 | 标签命名空间、结构体/联合体/枚举空间、普通标识符空间 |
| 类型               | 基础类型 + 派生类型(指针/数组/函数/结构体/联合体) |
| 算术类型           | 整型(`char`, `int`等) + 浮点型(`float`, `double`) |
| 对象与对齐         | 内存区域存储数据，`alignof`获取对齐要求，`_Alignas`指定对齐 |
| 主函数 `main`      | 程序入口，`int main(int argc, char* argv[])`，返回值0成功 |
| 如同规则           | 编译器可优化代码，只要可观测行为符合标准 |
| 未定义行为UB       | 标准未定义行为(如空指针解引用)，结果不可预测 |
| 内存模型与数据竞争 | C11引入，多线程访问共享数据需同步(`mutex`/原子操作) |

### 关键字

| 关键字                | 内容 |
| --------------------- | ---- |
| 标准关键字            | `auto`, `break`, `case`, `char`, `const`, `continue` 等32个 |
| C99新增关键字         | `_Bool`, `_Complex`, `_Imaginary`, `inline`, `restrict` |
| C11新增关键字         | `_Alignas`, `_Alignof`, `_Atomic`, `_Generic`, `_Noreturn`, `_Static_assert`, `_Thread_local` |
| C23新增关键字         | `alignas`, `alignof`, `bool`, `constexpr`, `false`, `true`, `nullptr` |
| 条件支持 asm, fortran | 编译器扩展关键字，用于内联汇编(`__asm__`)或Fortran互操作 |

### 预处理器

| 预处理器                          | 内容 |
| --------------------------------- | ---- |
| 条件编译指令，C23新增条件判断指令 | `#if`, `#ifdef`, `#elif`, `#else`, `#endif` + C23 `#elifdef`/`#elifndef` |
| 宏定义指令，字符串化/粘贴操作     | `#define`, `#undef` + `#`(字符串化), `##`(标记粘贴) |
| 文件包含指令                      | `#include <>`(系统头文件) / `#include ""`(用户头文件) |
| 编译器特定指令                    | `#pragma` 编译器扩展(如优化控制) |
| 行号与文件名                      | `#line <num> "filename"` 修改行号/文件名 |
| 错误控制指令，C23新增警告提示指令 | `#error "msg"` 强制错误 + C23 `#warning "msg"` |
| 其他控制指令，C23新增资源嵌入支持 | `#`(空指令) + C23 `#embed` 二进制资源嵌入 |

### 语句

| 语句                     | 内容 |
| ------------------------ | ---- |
| 标签语句，返回函数值语句 | `label:` (goto目标), `return expr;` |
| 表达式语句               | 表达式后跟`;` (如`x = 5;`) |
| 复合语句                 | `{...}` 代码块，创建作用域 |
| 选择语句                 | `if/else`, `switch/case/default` |
| 迭代语句                 | `for`, `while`, `do-while` |
| 跳转语句                 | `goto`, `break`, `continue` |

### 表达式

| 表达式           | 内容                                                         |
| ---------------- | ------------------------------------------------------------ |
| 值类别           | 左值(有地址)，右值(临时值)                                   |
| 求值顺序与序列点 | 序列点间求值顺序未定义(如`f() + g()`)                        |
| 常量表达式       | 编译时可求值表达式(如`3+4`)，用于数组大小/枚举值等           |
| 常量与字面量     | 整型(`42`)，浮点(`3.14`)，字符(`'A'`)，布尔(`true/false`)，空指针(`NULL`)，字符串(`"str"`)，复合字面量(`(int[]){1,2}`) |
| 运算符分类       | 成员访问与间接寻址(`.`/`->`)，逻辑(`&&`/`||`)，比较(`==`/`>`)，算术(`+`/`-`)，赋值(`=`/`+=`)，自增/自减(`++`/`--`)，函数调用(`()`)，逗号(`,`)，三元(`?:`)，`sizeof`/`alignof`，类型转换(`(type)`)，运算符优先级，泛型选择 `_Generic` |

### 初始化

| 初始化              | 内容 |
| ------------------- | ---- |
| 显示初始化          | `int x = 10;` 或指定初始化器(C99) `struct S s = {.a=1};` |
| 隐式初始化          | 静态存储期对象默认0初始化 |
| 空初始化            | `int x;` (自动存储期未初始化) |
| 标量初始化          | 基础类型初始化 `char c = 'X';` |
| 数组初始化          | `int arr[3] = {1,2,3};` 或部分初始化(其余为0) |
| 结构体/联合体初始化 | `struct Point p = {.x=1, .y=2};` 联合体初始化首个成员 |

### 声明

| 声明             | 内容                                                         |
| ---------------- | ------------------------------------------------------------ |
| 类型说明符       | `void`，算术(`char`/`int`等)，原子(`_Atomic int`)，`typedef`别名，`typeof`(GNU扩展)，`struct`/`union`/`enum`，位域(`int b:3;`) |
| 存储类说明符     | `typedef`(类型别名)，`constexpr`(C23编译时常量)，`auto`(自动存储期)，`register`(建议寄存器存储)，`static`(静态存储期)，`extern`(外部链接)，`_Thread_local`(线程局部存储) |
| 类型限定符       | `const`(不可修改)，`volatile`(防止优化)，`restrict`(指针独占访问)，`_Atomic`(原子访问) |
| 对齐说明符       | `_Alignas(n)` 或 C23 `alignas(n)` 指定对齐字节数             |
| 初始值设定项     | 声明时赋值表达式                                             |
| 属性声明列表     | `[[attr]]` C23标准属性(如`[[nodiscard]]`)                    |
| 声明定义与重声明 | 多次声明允许(需类型兼容)，单一定义规则(ODR)                  |
| 声明符           | 指针(`*p`)，数组(`arr[10]`)，函数(`int f()`)，枚举(`enum E`)，结构体(`struct S`)，联合体(`union U`)，位域(`int b:4;`) |

### 函数

| 函数      | 内容 |
| --------- | ---- |
| 函数声明  | `int func(int param);` (原型声明) |
| 函数定义  | `int func(int param) { ... }` 含函数体 |
| 可变参数  | `void func(int n, ...);` 用`va_list/va_start/va_arg/va_end`访问 |
| 内联函数  | `inline void f()` 建议编译器内联展开 |
| _Noreturn | `_Noreturn void exit();` 函数不返回 |

### 杂项和习语

| 杂项和习语       | 内容 |
| ---------------- | ---- |
| C 语言历史       | K&R C(1978) → ANSI C(1989) → C99 → C11 → C17 → C23 |
| 技术规范，合规性 | 遵循ISO/IEC 9899标准，`__STDC_VERSION__`宏检测版本 |
| 内联汇编         | `__asm__("指令" : 输出 : 输入 : 破坏列表)` 编译器扩展 |
| 信号处理         | `signal()`注册信号处理函数(SIGSEGV/SIGINT等) |
| 可分析性         | `static_assert`编译时断言，C23属性增强代码分析 |
