### æ·±å…¥è§£æ C++ å­—ç¬¦é›†ä¸ç¼–ç ä½“ç³»ï¼ˆC++23/26 æ ‡å‡†æ¼”è¿›ï¼‰

#### **1. C++ å­—ç¬¦é›†æ¶æ„åˆ†å±‚**
```mermaid
graph TD
    A[ç¿»è¯‘å­—ç¬¦é›†] --> B[åŸºæœ¬å­—ç¬¦é›†]
    A --> C[åŸºæœ¬æ–‡æœ¬å­—ç¬¦é›†]
    C --> D[æ‰§è¡Œå­—ç¬¦é›†]
    C --> E[æ‰§è¡Œå®½å­—ç¬¦é›†]
    D --> F[æ™®é€šæ–‡æœ¬ç¼–ç ]
    E --> G[å®½æ–‡æœ¬ç¼–ç ]
```

#### **2. æ ¸å¿ƒç»„ä»¶è¯¦è§£**

**2.1 ç¿»è¯‘å­—ç¬¦é›†ï¼ˆC++23 èµ·ï¼‰**
- **å®šä¹‰**ï¼šUnicode çš„è¶…é›†ï¼ŒåŒ…å«ï¼š
  - Unicode ä»£ç ç‚¹ï¼ˆU+0000 åˆ° U+10FFFFï¼‰
  - æœªåˆ†é…æ ‡é‡å€¼çš„ç‰¹æ®Šå­—ç¬¦
- **ä½œç”¨**ï¼šæºç åˆ°å†…éƒ¨è¡¨ç¤ºçš„æ¡¥æ¢
```cpp
// ç¤ºä¾‹ï¼šUnicode å­—ç¬¦ç›´æ¥ä½¿ç”¨
auto heart = u8"â¤";  // UTF-8 ç¼–ç  (C++17)
auto kanji = U"æ¼¢å­—"; // UTF-32 ç¼–ç  (C++11)
```

**2.2 åŸºæœ¬å­—ç¬¦é›†ï¼ˆC++26 æ¼”è¿›ï¼‰**
- **C++26 æ‰©å±•**ï¼šæ–°å¢ `$`, `@`, `` ` `` ä¸‰å­—ç¬¦ï¼ˆå…±99å­—ç¬¦ï¼‰
- **å®Œæ•´ç»„æˆ**ï¼š
  | ç±»å‹              | å­—ç¬¦ç¤ºä¾‹                          | æ•°é‡ |
  |-------------------|-----------------------------------|------|
  | ç©ºç™½æ§åˆ¶ç¬¦        | `\t` (U+0009), `\v` (U+000B)      | 4    |
  | å¯æ‰“å°å­—ç¬¦        | A-Z, a-z, 0-9, æ ‡ç‚¹ç¬¦å·           | 95   |
  | **C++26 æ–°å¢**    | `$` (U+0024), `@` (U+0040)        | +3   |
- **æºç ç¼–å†™çº¦æŸ**ï¼š
  ```cpp
  // åˆæ³•ç”¨æ³•ï¼ˆC++26ï¼‰
  string email = "user@domain.com"; 
  string path = R"(C:\$System)";     // åŸå§‹å­—ç¬¦ä¸²ä¸­çš„$
  ```

**2.3 åŸºæœ¬æ–‡æœ¬å­—ç¬¦é›†**
- **ç»„æˆ** = åŸºæœ¬å­—ç¬¦é›† + å…³é”®æ§åˆ¶ç¬¦ï¼š
  ```cpp
  // æ§åˆ¶å­—ç¬¦ç¤ºä¾‹
  char null_char = '\0';    // U+0000
  char bell_char = '\a';    // U+0007
  wchar_t backspace = L'\b';// U+0008
  ```
- **æ•°å€¼ç‰¹æ€§**ï¼š
  - `'0'` åˆ° `'9'` è¿ç»­é€’å¢ï¼ˆ`'1'-'0' == 1`ï¼‰
  - `\0` å€¼ä¸º 0ï¼ˆä½†å­˜å‚¨å½¢å¼ä¸ä¸€å®šæ˜¯å…¨é›¶ä½ï¼‰

**2.4 æ‰§è¡Œå­—ç¬¦é›†**
- **å…³é”®ç‰¹æ€§**ï¼š
  - è¶…é›†ï¼ˆåŒ…å«åŸºæœ¬æ–‡æœ¬å­—ç¬¦é›†ï¼‰
  - ç¼–ç åŒºåŸŸè®¾ç½®ç›¸å…³
  - å¤šå­—èŠ‚å­—ç¬¦æ”¯æŒ
```cpp
// å¤šå­—èŠ‚å­—ç¬¦ç¤ºä¾‹ï¼ˆä¾èµ–åŒºåŸŸè®¾ç½®ï¼‰
setlocale(LC_ALL, "ja_JP.UTF-8");
wstring_convert<codecvt_utf8<wchar_t>> conv;
wstring wide = conv.from_bytes("æ—¥æœ¬èª"); // å¤šå­—èŠ‚è½¬å®½å­—ç¬¦
```

#### **3. æ–‡å­—ç¼–ç æœºåˆ¶**

**3.1 ä»£ç å•å…ƒä¸ç¼–ç æ˜ å°„**
| å‰ç¼€   | ç¼–ç ç±»å‹          | å­—ç¬¦ç±»å‹   | å­˜å‚¨å¤§å° | ç¤ºä¾‹               |
|--------|-------------------|------------|----------|--------------------|
| æ—      | æ™®é€šæ–‡æœ¬ç¼–ç       | char       | 1+å­—èŠ‚   | "Hello"           |
| L      | å®½æ–‡æœ¬ç¼–ç         | wchar_t    | 2/4å­—èŠ‚  | L"Wide"           |
| u8     | UTF-8             | char       | 1-4å­—èŠ‚  | u8"ğŸ˜Š"            |
| u      | UTF-16 (C++23èµ·)  | char16_t   | 2/4å­—èŠ‚  | u"ğˆ" (U+10348)   |
| U      | UTF-32 (C++23èµ·)  | char32_t   | 4å­—èŠ‚    | U"ğ„" (U+1D11E)    |

**3.2 ç¼–ç è½¬æ¢å®æˆ˜**
```cpp
// UTF-8 åˆ° UTF-32 è½¬æ¢
#include <codecvt>
#include <locale>

int main() {
    std::u32string utf32 = U"Î©â‰ˆâˆšâˆ«"; // UTF-32 ç›´æ¥å­˜å‚¨
    
    // è½¬æ¢åˆ° UTF-8
    std::wstring_convert<std::codecvt_utf8<char32_t>, char32_t> conv;
    std::string utf8 = conv.to_bytes(utf32);
    
    // è¾“å‡ºå­—èŠ‚åºåˆ—
    for (char c : utf8) 
        std::cout << std::hex << (int)(unsigned char)c << ' ';
    // Î©: CE A9, â‰ˆ: E2 89 88, âˆš: E2 88 9A, âˆ«: E2 88 AB
}
```

**3.3 äºŒè¿›åˆ¶å®‰å…¨å¤„ç†**
```cpp
// å¤„ç†æ··åˆç¼–ç å­—ç¬¦ä¸²
void safe_print(const std::string& str) {
    for (size_t i = 0; i < str.size(); ) {
        int len = 1;
        // æ£€æµ‹UTF-8å¤šå­—èŠ‚åºåˆ—
        if ((str[i] & 0x80) != 0) {
            if      ((str[i] & 0xE0) == 0xC0) len = 2;
            else if ((str[i] & 0xF0) == 0xE0) len = 3;
            else if ((str[i] & 0xF8) == 0xF0) len = 4;
        }
        
        std::cout << str.substr(i, len) << " ";
        i += len;
    }
}
// è¾“å…¥ u8"aâœ“â‚¬" è¾“å‡º "a" "âœ“" "â‚¬"
```

#### **4. C++23/26 å…³é”®æ¼”è¿›**
- **æœ¯è¯­æ›´æ–°ï¼ˆC++23ï¼‰**ï¼š
  ```diff
  - åŸºæœ¬æºå­—ç¬¦é›† â†’ åŸºæœ¬å­—ç¬¦é›†
  - åŸºæœ¬æ‰§è¡Œå­—ç¬¦é›† â†’ åŸºæœ¬æ–‡æœ¬å­—ç¬¦é›†
  ```
- **å¼ºåˆ¶ Unicode ç¼–ç ï¼ˆC++23ï¼‰**ï¼š
  - `u8`/`u`/`U` å‰ç¼€ä¸¥æ ¼å¯¹åº” UTF-8/16/32
- **æ–°å¢å­—ç¬¦ï¼ˆC++26ï¼‰**ï¼š
  - `$`, `@`, `` ` `` æˆä¸ºåŸºæœ¬å­—ç¬¦é›†æˆå‘˜
  ```cpp
  // C++26 æ–°ç‰¹æ€§åº”ç”¨
  template<typename T>
  concept Money = requires(T t) {
      { t } -> std::convertible_to<@currency_type>; // @ ä½œä¸ºæ¦‚å¿µçº¦æŸç¬¦
  };
  ```

#### **5. è·¨å¹³å°æ³¨æ„äº‹é¡¹**
- **å®½å­—ç¬¦å¤§å°å·®å¼‚**ï¼š
  ```cpp
  static_assert(sizeof(wchar_t) == 2 || sizeof(wchar_t) == 4, 
                "wchar_t size implementation-defined");
  ```
- **æ¢è¡Œç¬¦å¤„ç†**ï¼š
  ```cpp
  // å®‰å…¨å†™å…¥è·¨å¹³å°æ¢è¡Œ
  std::ofstream file("log.txt");
  #ifdef _WIN32
      file << "Line1\r\n";
  #else
      file << "Line1\n";
  #endif
  ```
- **ç¼–ç æ£€æµ‹æœ€ä½³å®è·µ**ï¼š
  ```cpp
  // BOM å¤„ç† (Byte Order Mark)
  std::ifstream file("data.txt", std::ios::binary);
  char bom[3]{};
  file.read(bom, 3);
  if (bom[0] == '\xEF' && bom[1] == '\xBB' && bom[2] == '\xBF') {
      std::cout << "UTF-8 with BOM";
  }
  ```

### **æ€»ç»“ä¸å¼€å‘æŒ‡å—**
1. **å­—ç¬¦é›†å±‚çº§å…³ç³»**ï¼š
   - ç¿»è¯‘å­—ç¬¦é›† âŠ‡ åŸºæœ¬å­—ç¬¦é›† âŠ‚ åŸºæœ¬æ–‡æœ¬å­—ç¬¦é›† âŠ‚ æ‰§è¡Œå­—ç¬¦é›†
2. **ç°ä»£ C++ ç¼–ç åŸåˆ™**ï¼š
   - ä¼˜å…ˆä½¿ç”¨ `u8` å‰ç¼€ä¿è¯ UTF-8 å…¼å®¹
   - é¿å…ä¾èµ– `wchar_t` å¤§å°ï¼ˆç”¨ `char16_t`/`char32_t`ï¼‰
   - C++26 ä»£ç å¯è‡ªç”±ä½¿ç”¨ `$` `@` `` ` `` ç¬¦å·
3. **å…³é”®æ•°å€¼ä¿è¯**ï¼š
   - `\0` å€¼ä¸º 0
   - `'0'` åˆ° `'9'` è¿ç»­é€’å¢
   - åŸºæœ¬å­—ç¬¦å•å­—èŠ‚è¡¨ç¤º
4. **å…¼å®¹æ€§å¤„ç†**ï¼š
   ```cpp
   #if __cplusplus >= 202302L
   // C++23+ Unicode ä¸¥æ ¼æ¨¡å¼
   #define UNICODE_STR(s) u8##s
   #else
   // ä¼ ç»Ÿå®ç°å®šä¹‰ç¼–ç 
   #define UNICODE_STR(s) s
   #endif
   
   std::cout << UNICODE_STR("æ—¥æœ¬èª");
   ```

> **æœ€ç»ˆç»“è®º**ï¼šC++ é€šè¿‡åˆ†å±‚å­—ç¬¦é›†æ¨¡å‹å°†æºç è¡¨ç¤ºï¼ˆåŸºæœ¬å­—ç¬¦é›†ï¼‰ã€æ‰§è¡Œç¯å¢ƒï¼ˆæ‰§è¡Œå­—ç¬¦é›†ï¼‰å’Œç‰©ç†ç¼–ç ï¼ˆæ–‡å­—ç¼–ç ï¼‰è§£è€¦ã€‚C++23/26 æ ‡å‡†é€šè¿‡æ‹¥æŠ± Unicode å’Œæ‰©å±•åŸºæœ¬å­—ç¬¦é›†ï¼Œæ˜¾è‘—æå‡äº†æ–‡æœ¬å¤„ç†çš„ç°ä»£åŒ–ç¨‹åº¦ã€‚å¼€å‘è€…åº”ï¼š
> 1. ç†è§£å„å±‚å­—ç¬¦é›†çš„è¾¹ç•Œ
> 2. æ–°é¡¹ç›®ä¼˜å…ˆä½¿ç”¨ UTF-8 ç¼–ç 
> 3. è·¨å¹³å°ä»£ç å¤„ç†å®½å­—ç¬¦å¤§å°å·®å¼‚
> 4. åˆ©ç”¨ `std::codecvt` è¿›è¡Œå®‰å…¨ç¼–ç è½¬æ¢
> 5. å…³æ³¨ C++26 å¯¹ `$` `@` `` ` `` çš„æ–°æ”¯æŒ